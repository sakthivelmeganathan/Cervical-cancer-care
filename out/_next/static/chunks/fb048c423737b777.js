(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,51700,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(11795),i=e.i(18566);function n(){let[e,n]=(0,a.useState)(!1),d=(0,s.createClient)(),r=(0,i.useRouter)(),l=async e=>{e.preventDefault(),n(!0);try{let{data:{user:e}}=await d.auth.getUser();if(!e)throw Error("Not authenticated");let t=e.user_metadata?.full_name||"User",a=e.user_metadata?.role||"patient",{error:s}=await d.from("users").upsert({id:e.id,email:e.email,full_name:t,role:a});if(s)throw s;if("patient"===a){let{error:t}=await d.from("patients").upsert({user_id:e.id},{onConflict:"user_id"});if(t)throw t}r.refresh(),window.location.reload()}catch(e){console.error("Error repairing profile:",e),alert("Failed to repair profile: "+(e instanceof Error?e.message:"Unknown error"))}finally{n(!1)}};return(0,t.jsx)("button",{type:"button",onClick:l,className:"btn btn-primary btn-sm",disabled:e,children:e?"Repairing...":"Repair Profile"})}e.s(["SyncProfileButton",()=>n])},95790,e=>{e.v({actions:"page-module__2pjshG__actions",actionsCard:"page-module__2pjshG__actionsCard",appointmentDate:"page-module__2pjshG__appointmentDate",appointmentDetails:"page-module__2pjshG__appointmentDetails",appointmentDoctor:"page-module__2pjshG__appointmentDoctor",appointmentItem:"page-module__2pjshG__appointmentItem",appointmentType:"page-module__2pjshG__appointmentType",appointmentsCard:"page-module__2pjshG__appointmentsCard",appointmentsList:"page-module__2pjshG__appointmentsList",container:"page-module__2pjshG__container",emptyState:"page-module__2pjshG__emptyState",grid:"page-module__2pjshG__grid",header:"page-module__2pjshG__header",medicationDosage:"page-module__2pjshG__medicationDosage",medicationItem:"page-module__2pjshG__medicationItem",medicationName:"page-module__2pjshG__medicationName",medicationsCard:"page-module__2pjshG__medicationsCard",medicationsList:"page-module__2pjshG__medicationsList",stat:"page-module__2pjshG__stat",statLabel:"page-module__2pjshG__statLabel",statValue:"page-module__2pjshG__statValue",stats:"page-module__2pjshG__stats",statsCard:"page-module__2pjshG__statsCard"})},95111,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(18566),i=e.i(11795),n=e.i(95790),d=e.i(51700),r=e.i(22016),l=e.i(83773);function o({userData:e,appointments:a,medications:s,lastScreening:i}){let{t:d}=(0,l.useLanguage)();return(0,t.jsxs)("div",{className:n.default.container,children:[(0,t.jsxs)("header",{className:n.default.header,children:[(0,t.jsxs)("h1",{children:[d("patient.dashboard.welcome"),", ",e?.full_name]}),(0,t.jsx)("p",{children:d("patient.dashboard.healthDashboard")})]}),(0,t.jsxs)("div",{className:n.default.grid,children:[(0,t.jsxs)("div",{className:`card ${n.default.aboutCard}`,style:{gridColumn:"1 / -1",background:"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)",color:"white"},children:[(0,t.jsx)("h2",{style:{color:"white",borderBottom:"1px solid rgba(255,255,255,0.2)"},children:d("patient.dashboard.aboutTitle")}),(0,t.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"2rem",marginTop:"1rem"},children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("h3",{style:{fontSize:"1.1rem",marginBottom:"0.5rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:["ðŸ“Š ",d("patient.dashboard.realTimeTracking")]}),(0,t.jsx)("p",{style:{opacity:.9,fontSize:"0.95rem"},children:d("patient.dashboard.realTimeDesc")})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("h3",{style:{fontSize:"1.1rem",marginBottom:"0.5rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:["ðŸ‘©â€âš•ï¸ ",d("patient.dashboard.doctorConnection")]}),(0,t.jsx)("p",{style:{opacity:.9,fontSize:"0.95rem"},children:d("patient.dashboard.doctorDesc")})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("h3",{style:{fontSize:"1.1rem",marginBottom:"0.5rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:["ðŸ“š ",d("patient.dashboard.educationalResources")]}),(0,t.jsx)("p",{style:{opacity:.9,fontSize:"0.95rem"},children:d("patient.dashboard.eduDesc")})]})]})]}),(0,t.jsxs)("div",{className:`card ${n.default.statsCard}`,children:[(0,t.jsx)("h2",{children:d("patient.dashboard.healthOverview")}),(0,t.jsxs)("div",{className:n.default.stats,children:[(0,t.jsxs)("div",{className:n.default.stat,children:[(0,t.jsx)("span",{className:n.default.statLabel,children:d("patient.dashboard.upcomingAppointments")}),(0,t.jsx)("span",{className:n.default.statValue,children:a?.length||0})]}),(0,t.jsxs)("div",{className:n.default.stat,children:[(0,t.jsx)("span",{className:n.default.statLabel,children:d("patient.dashboard.activeMedications")}),(0,t.jsx)("span",{className:n.default.statValue,children:s?.length||0})]})]}),(0,t.jsxs)("div",{style:{marginTop:"1.5rem",paddingTop:"1rem",borderTop:"1px solid #e2e8f0"},children:[(0,t.jsx)("h3",{style:{fontSize:"0.9rem",color:"#64748b",marginBottom:"0.5rem",textTransform:"uppercase",letterSpacing:"0.05em"},children:d("patient.dashboard.latestScreening")}),i?(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{style:{fontSize:"1.1rem",fontWeight:600,color:"#0f172a"},children:i.result||d("patient.dashboard.pending")}),(0,t.jsx)("div",{style:{fontSize:"0.85rem",color:"#64748b"},children:new Date(i.screening_date).toLocaleDateString()})]}):(0,t.jsx)("div",{style:{fontSize:"0.9rem",color:"#94a3b8",fontStyle:"italic"},children:d("patient.dashboard.noRecords")})]})]}),(0,t.jsxs)("div",{className:`card ${n.default.appointmentsCard}`,children:[(0,t.jsx)("h2",{children:d("patient.dashboard.upcomingAppointments")}),a&&a.length>0?(0,t.jsx)("div",{className:n.default.appointmentsList,children:a.map(e=>(0,t.jsxs)("div",{className:n.default.appointmentItem,children:[(0,t.jsx)("div",{className:n.default.appointmentDate,children:new Date(e.appointment_date).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}),(0,t.jsxs)("div",{className:n.default.appointmentDetails,children:[(0,t.jsx)("div",{className:n.default.appointmentType,children:e.appointment_type.replace("_"," ")}),(0,t.jsxs)("div",{className:n.default.appointmentDoctor,children:["Dr. ",e.doctor?.full_name]})]}),(0,t.jsx)("span",{className:`badge ${"confirmed"===e.status||"scheduled"===e.status?"badge-success":"pending"===e.status?"badge-warning":"badge-error"}`,children:e.status})]},e.id))}):(0,t.jsx)("p",{className:n.default.emptyState,children:d("patient.dashboard.noAppointments")})]}),(0,t.jsxs)("div",{className:`card ${n.default.medicationsCard}`,children:[(0,t.jsx)("h2",{children:d("patient.dashboard.activeMedications")}),s&&s.length>0?(0,t.jsx)("div",{className:n.default.medicationsList,children:s.map(e=>(0,t.jsxs)("div",{className:n.default.medicationItem,children:[(0,t.jsx)("div",{className:n.default.medicationName,children:e.medication_name}),(0,t.jsxs)("div",{className:n.default.medicationDosage,children:[e.dosage," - ",e.frequency]})]},e.id))}):(0,t.jsx)("p",{className:n.default.emptyState,children:d("patient.dashboard.noMedications")})]}),(0,t.jsxs)("div",{className:`card ${n.default.actionsCard}`,children:[(0,t.jsx)("h2",{children:d("patient.dashboard.quickActions")}),(0,t.jsxs)("div",{className:n.default.actions,children:[(0,t.jsx)(r.default,{href:"/patient/symptoms",className:"btn btn-primary",children:d("patient.dashboard.logSymptoms")}),(0,t.jsx)(r.default,{href:"/patient/appointments",className:"btn btn-outline",children:d("patient.dashboard.bookAppointment")}),(0,t.jsx)(r.default,{href:"/patient/education",className:"btn btn-outline",children:d("patient.dashboard.learnMore")})]})]})]})]})}function c(){let e=(0,s.useRouter)(),r=(0,i.createClient)(),[l,c]=(0,a.useState)(!0),[p,m]=(0,a.useState)(null),[h,u]=(0,a.useState)(null),[_,g]=(0,a.useState)(null);return((0,a.useEffect)(()=>{!async function(){let{data:{user:t}}=await r.auth.getUser();if(!t)return e.push("/login");g(t);let{data:a,error:s}=await r.from("users").select("*").eq("id",t.id).single();if(s||!a){u("profile_missing"),c(!1);return}if("patient"!==a.role)return e.push("/doctor/dashboard");let{data:i}=await r.from("patients").select("*").eq("user_id",t.id).maybeSingle(),n=i?.id,{data:d}=await r.from("appointments").select(`
                    *,
                    doctor:users!appointments_doctor_id_fkey(full_name)
                `).eq("patient_id",n).in("status",["scheduled","pending","confirmed"]).gte("appointment_date",new Date().toISOString()).order("appointment_date",{ascending:!0}).limit(5),{data:l}=await r.from("medications").select("*").eq("patient_id",n).eq("status","active").order("created_at",{ascending:!1}).limit(5),{data:o}=await r.from("screening_records").select("*").eq("patient_id",n).order("screening_date",{ascending:!1}).limit(1).maybeSingle();m({userData:a,appointments:d||[],medications:l||[],lastScreening:o}),c(!1)}()},[e,r]),l)?(0,t.jsx)("div",{style:{padding:"2rem",textAlign:"center"},children:"Loading dashboard..."}):"profile_missing"===h?(0,t.jsx)("div",{className:n.default.container,children:(0,t.jsxs)("div",{className:"alert alert-error",style:{flexDirection:"column",alignItems:"flex-start",gap:"1rem"},children:[(0,t.jsx)("p",{children:(0,t.jsx)("strong",{children:"User Profile Missing"})}),(0,t.jsxs)("p",{children:["Auth ID: ",(0,t.jsx)("code",{children:_?.id})]}),(0,t.jsx)("p",{children:"This account exists in login system but is missing database records."}),(0,t.jsx)("div",{style:{display:"flex",gap:"1rem",alignItems:"center"},children:(0,t.jsx)("form",{action:"/api/auth/sync",method:"POST",children:(0,t.jsx)(d.SyncProfileButton,{})})})]})}):p?(0,t.jsx)(o,{userData:p.userData,appointments:p.appointments,medications:p.medications,lastScreening:p.lastScreening}):null}e.s(["default",()=>c],95111)}]);