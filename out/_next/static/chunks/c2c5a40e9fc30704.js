(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,84614,e=>{"use strict";let t=(0,e.i(75254).default)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);e.s(["User",()=>t],84614)},79002,e=>{"use strict";let t=(0,e.i(75254).default)("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);e.s(["UserPlus",()=>t],79002)},51700,e=>{"use strict";var t=e.i(43476),i=e.i(71645),r=e.i(11795),n=e.i(18566);function o(){let[e,o]=(0,i.useState)(!1),a=(0,r.createClient)(),s=(0,n.useRouter)(),d=async e=>{e.preventDefault(),o(!0);try{let{data:{user:e}}=await a.auth.getUser();if(!e)throw Error("Not authenticated");let t=e.user_metadata?.full_name||"User",i=e.user_metadata?.role||"patient",{error:r}=await a.from("users").upsert({id:e.id,email:e.email,full_name:t,role:i});if(r)throw r;if("patient"===i){let{error:t}=await a.from("patients").upsert({user_id:e.id},{onConflict:"user_id"});if(t)throw t}s.refresh(),window.location.reload()}catch(e){console.error("Error repairing profile:",e),alert("Failed to repair profile: "+(e instanceof Error?e.message:"Unknown error"))}finally{o(!1)}};return(0,t.jsx)("button",{type:"button",onClick:d,className:"btn btn-primary btn-sm",disabled:e,children:e?"Repairing...":"Repair Profile"})}e.s(["SyncProfileButton",()=>o])},5290,e=>{e.v({centerColumn:"page-module__O22zzq__centerColumn",container:"page-module__O22zzq__container",mainGrid:"page-module__O22zzq__mainGrid",statsGrid:"page-module__O22zzq__statsGrid",welcomeSection:"page-module__O22zzq__welcomeSection",welcomeSubtitle:"page-module__O22zzq__welcomeSubtitle",welcomeTitle:"page-module__O22zzq__welcomeTitle"})},32312,e=>{"use strict";var t=e.i(43476),i=e.i(71645),r=e.i(18566),n=e.i(11795),o=e.i(5290);function a({title:e,value:i,subtext:r,icon:n,color:o}){return(0,t.jsxs)("div",{style:{backgroundColor:o,borderRadius:"16px",padding:"1.5rem",color:"white",display:"flex",alignItems:"center",gap:"1.5rem",minWidth:"240px",flex:1},children:[(0,t.jsx)("div",{style:{backgroundColor:"rgba(255, 255, 255, 0.2)",borderRadius:"12px",padding:"12px",display:"flex",alignItems:"center",justifyContent:"center"},children:n}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{style:{fontSize:"1.5rem",fontWeight:700,margin:0,lineHeight:1},children:i}),(0,t.jsx)("p",{style:{margin:"4px 0 0 0",fontSize:"0.9rem",opacity:.9},children:r})]})]})}var s=e.i(43531),d=e.i(37727),l=e.i(83773);let c={backgroundColor:"white",borderRadius:"16px",padding:"1.5rem",boxShadow:"0 2px 10px rgba(0,0,0,0.02)",height:"100%"},p={display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem"},u={fontSize:"1.1rem",fontWeight:600,color:"#0f172a"},m={fontSize:"0.85rem",color:"#3b82f6",textDecoration:"none",cursor:"pointer"},h={display:"flex",flexDirection:"column",gap:"1.25rem"},f={display:"flex",justifyContent:"space-between",alignItems:"center"},x={display:"flex",gap:"1rem",alignItems:"center"},g={width:"48px",height:"48px",borderRadius:"50%",backgroundColor:"#e2e8f0",objectFit:"cover"},y={fontSize:"0.95rem",fontWeight:600,color:"#0f172a",display:"block"},b={fontSize:"0.8rem",color:"#64748b"},j={display:"flex",gap:"0.5rem"},_={width:"32px",height:"32px",borderRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center",border:"none",cursor:"pointer",transition:"all 0.2s"},w={backgroundColor:"#dcfce7",color:"#166534"},v={backgroundColor:"#fee2e2",color:"#991b1b"};function S({appointments:e}){let o=(0,n.createClient)(),a=(0,r.useRouter)(),{t:S}=(0,l.useLanguage)(),[C,z]=i.default.useState(null),[k,q]=i.default.useState(""),D=async(t,i)=>{if("scheduled"===i){let i=e.find(e=>e.id===t);if(i){z(i);let e=new Date(i.appointment_date);q(new Date(e.getTime()-6e4*e.getTimezoneOffset()).toISOString().slice(0,16))}return}try{let r=e.find(e=>e.id===t),{error:n}=await o.from("appointments").update({status:i}).eq("id",t);if(n)throw n;if(r?.patient?.user_id){let e=new Date(r.appointment_date).toLocaleDateString();await o.from("notifications").insert({user_id:r.patient.user_id,title:"Appointment Declined",message:`Your appointment request for ${e} has been declined.`,type:"appointment_cancelled"})}a.refresh()}catch(e){console.error("Error updating appointment:",e),alert("Failed to update appointment status")}},R=async()=>{if(C&&k)try{let{error:e}=await o.from("appointments").update({status:"scheduled",appointment_date:new Date(k).toISOString()}).eq("id",C.id);if(e)throw e;if(C.patient?.user_id){let e=new Date(k).toLocaleString([],{dateStyle:"medium",timeStyle:"short"});await o.from("notifications").insert({user_id:C.patient.user_id,title:"Appointment Scheduled",message:`Your appointment has been scheduled for ${e}.`,type:"appointment_scheduled"})}z(null),a.refresh()}catch(e){console.error("Error scheduling appointment:",e),alert("Failed to schedule appointment")}};return(0,t.jsxs)("div",{style:c,children:[(0,t.jsxs)("div",{style:p,children:[(0,t.jsx)("h3",{style:u,children:S("doctor.dashboard.requests.title")}),(0,t.jsxs)("span",{style:m,children:[S("doctor.dashboard.requests.viewAll")," >"]})]}),(0,t.jsxs)("div",{style:h,children:[0===e.length&&(0,t.jsx)("p",{style:{color:"#94a3b8",fontSize:"0.9rem",textAlign:"center",padding:"1rem"},children:S("doctor.dashboard.requests.noPending")}),e.map(e=>(0,t.jsxs)("div",{style:f,children:[(0,t.jsxs)("div",{style:x,children:[(0,t.jsx)("img",{src:`https://ui-avatars.com/api/?name=${e.patient?.user?.full_name||"User"}&background=random`,alt:e.patient?.user?.full_name,style:g}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{style:y,children:e.patient?.user?.full_name}),(0,t.jsxs)("span",{style:b,children:[new Date(e.appointment_date).toLocaleDateString()," â€¢ ",new Date(e.appointment_date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]})]}),(0,t.jsxs)("div",{style:j,children:[(0,t.jsx)("button",{style:{..._,...v},onClick:()=>D(e.id,"cancelled"),title:S("doctor.dashboard.requests.decline"),children:(0,t.jsx)(d.X,{size:16})}),(0,t.jsx)("button",{style:{..._,...w},onClick:()=>D(e.id,"scheduled"),title:S("doctor.dashboard.requests.confirm"),children:(0,t.jsx)(s.Check,{size:16})})]})]},e.id))]}),C&&(0,t.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:(0,t.jsxs)("div",{style:{backgroundColor:"white",padding:"2rem",borderRadius:"16px",width:"90%",maxWidth:"400px",boxShadow:"0 20px 25px -5px rgb(0 0 0 / 0.1)"},children:[(0,t.jsx)("h3",{style:{fontSize:"1.25rem",fontWeight:600,marginBottom:"1rem"},children:S("doctor.dashboard.requests.modalTitle")}),(0,t.jsxs)("p",{style:{marginBottom:"1.5rem",color:"#64748b"},children:[S("doctor.dashboard.requests.modalSubtitle")," ",C.patient?.user?.full_name,"."]}),(0,t.jsxs)("div",{style:{marginBottom:"1.5rem"},children:[(0,t.jsx)("label",{style:{display:"block",fontSize:"0.9rem",fontWeight:500,marginBottom:"0.5rem"},children:S("doctor.dashboard.requests.scheduleTime")}),(0,t.jsx)("input",{type:"datetime-local",value:k,onChange:e=>q(e.target.value),style:{width:"100%",padding:"0.75rem",borderRadius:"8px",border:"1px solid #e2e8f0",fontSize:"1rem"}})]}),(0,t.jsxs)("div",{style:{display:"flex",gap:"1rem",justifyContent:"flex-end"},children:[(0,t.jsx)("button",{onClick:()=>z(null),style:{padding:"0.75rem 1.5rem",borderRadius:"8px",border:"1px solid #e2e8f0",backgroundColor:"white",cursor:"pointer",fontWeight:500},children:S("doctor.dashboard.requests.cancel")}),(0,t.jsx)("button",{onClick:R,style:{padding:"0.75rem 1.5rem",borderRadius:"8px",border:"none",backgroundColor:"#0f172a",color:"white",cursor:"pointer",fontWeight:500},children:S("doctor.dashboard.requests.confirmSchedule")})]})]})})]})}var C=e.i(84614),z=e.i(79002);function k({totalPatients:e}){let{t:i}=(0,l.useLanguage)(),r=Math.floor(.15*e);return(0,t.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"16px",padding:"1.5rem",boxShadow:"0 2px 10px rgba(0,0,0,0.02)",height:"100%",display:"flex",flexDirection:"column",gap:"1.5rem"},children:[(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,t.jsx)("h3",{style:{fontSize:"1.1rem",fontWeight:600,color:"#0f172a",margin:0},children:i("doctor.dashboard.patientStats.title")}),(0,t.jsx)("select",{style:{border:"none",color:"#64748b",fontSize:"0.85rem",backgroundColor:"transparent",cursor:"pointer"},children:(0,t.jsx)("option",{children:"2025"})})]}),(0,t.jsxs)("div",{style:{display:"flex",gap:"1rem",flexDirection:"column"},children:[(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"1rem",padding:"1rem",backgroundColor:"#f8fafc",borderRadius:"12px"},children:[(0,t.jsx)("div",{style:{width:"40px",height:"40px",borderRadius:"50%",backgroundColor:"#dbeafe",color:"#2563eb",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,t.jsx)(z.UserPlus,{size:20})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{style:{fontSize:"1.1rem",fontWeight:700,color:"#0f172a"},children:r}),(0,t.jsx)("div",{style:{fontSize:"0.8rem",color:"#64748b"},children:i("doctor.dashboard.patientStats.new")})]}),(0,t.jsx)("span",{style:{marginLeft:"auto",fontSize:"0.8rem",color:"#16a34a",fontWeight:600},children:"+15%"})]}),(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"1rem",padding:"1rem",backgroundColor:"#ffff",borderRadius:"12px"},children:[(0,t.jsx)("div",{style:{width:"40px",height:"40px",borderRadius:"50%",backgroundColor:"#ffedd5",color:"#ea580c",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,t.jsx)(C.User,{size:20})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{style:{fontSize:"1.1rem",fontWeight:700,color:"#0f172a"},children:e-r}),(0,t.jsx)("div",{style:{fontSize:"0.8rem",color:"#64748b"},children:i("doctor.dashboard.patientStats.old")})]}),(0,t.jsx)("span",{style:{marginLeft:"auto",fontSize:"0.8rem",color:"#16a34a",fontWeight:600},children:"+15%"})]})]})]})}var q=e.i(22016),D=e.i(23585);let R={width:"100%",borderCollapse:"collapse",marginTop:"1rem"},P={textAlign:"left",padding:"1rem",fontSize:"0.85rem",fontWeight:600,color:"#64748b",borderBottom:"1px solid #e2e8f0",backgroundColor:"#f8fafc"},I={padding:"1rem",fontSize:"0.9rem",color:"#334155",borderBottom:"1px solid #f1f5f9"},A={display:"flex",alignItems:"center",gap:"0.75rem"},T={width:"32px",height:"32px",borderRadius:"50%",backgroundColor:"#e2e8f0",objectFit:"cover"},W={display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0 1rem"},O={fontSize:"1.25rem",fontWeight:700,color:"#0f172a"},U={fontSize:"0.9rem",color:"#3b82f6",textDecoration:"none"};function L({patients:e}){let{t:i}=(0,l.useLanguage)();return(0,t.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"16px",padding:"1.5rem",marginTop:"2rem"},children:[(0,t.jsxs)("div",{style:W,children:[(0,t.jsx)("h3",{style:O,children:i("doctor.dashboard.recentPatients.title")}),(0,t.jsxs)(q.default,{href:"/doctor/patients",style:U,children:[i("doctor.dashboard.recentPatients.viewAll")," >"]})]}),(0,t.jsx)("div",{style:{overflowX:"auto"},children:(0,t.jsxs)("table",{style:R,children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{style:P,children:i("doctor.dashboard.recentPatients.table.name")}),(0,t.jsx)("th",{style:P,children:i("doctor.dashboard.recentPatients.table.visitId")}),(0,t.jsx)("th",{style:P,children:i("doctor.dashboard.recentPatients.table.date")}),(0,t.jsx)("th",{style:P,children:i("doctor.dashboard.recentPatients.table.gender")}),(0,t.jsx)("th",{style:P,children:i("doctor.dashboard.recentPatients.table.diseases")}),(0,t.jsx)("th",{style:P,children:i("doctor.dashboard.recentPatients.table.status")}),(0,t.jsx)("th",{style:P})]})}),(0,t.jsxs)("tbody",{children:[0===e.length&&(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:7,style:{...I,textAlign:"center",color:"#94a3b8"},children:i("doctor.dashboard.recentPatients.noRecent")})}),e.map(e=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{style:I,children:(0,t.jsxs)("div",{style:A,children:[(0,t.jsx)("img",{src:`https://ui-avatars.com/api/?name=${e.user?.full_name||"User"}&background=random`,alt:"",style:T}),(0,t.jsx)("span",{style:{fontWeight:500},children:e.user?.full_name})]})}),(0,t.jsx)("td",{style:I,children:e.id.substring(0,8).toUpperCase()}),(0,t.jsx)("td",{style:I,children:new Date(e.created_at).toLocaleDateString()}),(0,t.jsx)("td",{style:I,children:e.gender||"Female"}),(0,t.jsx)("td",{style:I,children:"-"}),(0,t.jsx)("td",{style:I,children:(0,t.jsx)("span",{style:{color:"#64748b"},children:"Out-Patient"})}),(0,t.jsx)("td",{style:I,children:(0,t.jsx)(D.MoreVertical,{size:16,color:"#94a3b8",style:{cursor:"pointer"}})})]},e.id))]})]})})]})}var B=e.i(87316),N=e.i(75254);let F=(0,N.default)("briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]),E=(0,N.default)("video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);function G({userData:e,totalAppointments:i,patientCount:r,pendingCount:n,upcomingCount:s,upcomingAppointments:d,pendingAppointments:c,recentPatients:p}){let{t:u}=(0,l.useLanguage)();return(0,t.jsxs)("div",{className:o.default.container,children:[(0,t.jsxs)("div",{className:o.default.welcomeSection,children:[(0,t.jsxs)("h1",{className:o.default.welcomeTitle,children:[u("doctor.dashboard.welcome")," ",e?.full_name?.split(" ")[0]||"Doctor"]}),(0,t.jsx)("p",{className:o.default.welcomeSubtitle,children:u("doctor.dashboard.subtitle")})]}),(0,t.jsxs)("div",{className:o.default.statsGrid,children:[(0,t.jsx)(a,{title:u("doctor.dashboard.stats.appointments"),value:i?.toString()||"0",subtext:u("doctor.dashboard.stats.allTime"),icon:(0,t.jsx)(B.Calendar,{size:24,color:"white"}),color:"#8b5cf6"}),(0,t.jsx)(a,{title:u("doctor.dashboard.stats.patients"),value:r?.toString()||"0",subtext:u("doctor.dashboard.stats.registered"),icon:(0,t.jsx)(C.User,{size:24,color:"white"}),color:"#f43f5e"}),(0,t.jsx)(a,{title:u("doctor.dashboard.stats.pending"),value:n?.toString()||"0",subtext:u("doctor.dashboard.stats.awaiting"),icon:(0,t.jsx)(F,{size:24,color:"white"}),color:"#f59e0b"}),(0,t.jsx)(a,{title:u("doctor.dashboard.stats.upcoming"),value:s?.toString()||"0",subtext:u("doctor.dashboard.stats.next10"),icon:(0,t.jsx)(E,{size:24,color:"white"}),color:"#0ea5e9"})]}),(0,t.jsxs)("div",{className:o.default.mainGrid,children:[(0,t.jsx)(S,{appointments:c||[]}),(0,t.jsx)("div",{className:o.default.centerColumn,children:(0,t.jsx)(k,{totalPatients:r||0})})]}),(0,t.jsx)(L,{patients:p||[]})]})}var M=e.i(51700);function $(){let e=(0,r.useRouter)(),a=(0,n.createClient)(),[s,d]=(0,i.useState)(!0),[l,c]=(0,i.useState)(null),[p,u]=(0,i.useState)(null);return((0,i.useEffect)(()=>{!async function(){let{data:{user:t}}=await a.auth.getUser();if(!t)return e.push("/login");let{data:i,error:r}=await a.from("users").select("*").eq("id",t.id).single();if(r||!i){console.error("User profile not found:",r),u("profile_not_found"),d(!1);return}if("doctor"!==i.role)return e.push("/patient/dashboard");let{data:n}=await a.from("appointments").select(`
                    *,
                    patient:patients!appointments_patient_id_fkey(
                        id,
                        user:users!patients_user_id_fkey(full_name)
                    )
                `).eq("doctor_id",t.id).gte("appointment_date",new Date().toISOString()).order("appointment_date",{ascending:!0}).limit(10),{data:o}=await a.from("patient_doctors").select("patient_id").eq("doctor_id",t.id),s=o?.map(e=>e.patient_id)||[],l=0,p=[];if(s.length>0){let{data:e}=await a.from("patients").select("user_id").in("id",s),t=e?.map(e=>e.user_id)||[];l=s.length;let{data:i}=await a.from("users").select("*").in("id",t).order("created_at",{ascending:!1}).limit(10);p=i||[]}let{count:m}=await a.from("appointments").select("*",{count:"exact",head:!0}).eq("doctor_id",t.id),{count:h}=await a.from("appointments").select("*",{count:"exact",head:!0}).eq("doctor_id",t.id).eq("status","pending"),{data:f}=await a.from("appointments").select(`
                    id,
                    appointment_date,
                    appointment_type,
                    created_at,
                    patient:patients!appointments_patient_id_fkey(
                        user_id,
                        user:users!patients_user_id_fkey(full_name)
                    )
                `).eq("doctor_id",t.id).eq("status","pending").order("created_at",{ascending:!1}).limit(5),x=p.map(e=>({id:e.id,created_at:e.created_at||new Date().toISOString(),gender:"Female",user:{full_name:e.full_name,email:e.email}}));c({userData:i,totalAppointments:m||0,patientCount:l,pendingCount:h||0,upcomingCount:n?.length||0,upcomingAppointments:n||[],pendingAppointments:f||[],recentPatients:x}),d(!1)}()},[e,a]),s)?(0,t.jsx)("div",{style:{padding:"2rem",textAlign:"center"},children:"Loading dashboard..."}):"profile_not_found"===p?(0,t.jsx)("div",{className:o.default.container,children:(0,t.jsxs)("div",{className:"alert alert-error",style:{flexDirection:"column",alignItems:"flex-start",gap:"1rem"},children:[(0,t.jsx)("p",{children:"User profile not found. This can happen if the account setup didn't complete."}),(0,t.jsx)("form",{action:"/api/auth/sync",method:"POST",children:(0,t.jsx)(M.SyncProfileButton,{})})]})}):l?(0,t.jsx)(G,{userData:l.userData,totalAppointments:l.totalAppointments,patientCount:l.patientCount,pendingCount:l.pendingCount,upcomingCount:l.upcomingCount,upcomingAppointments:l.upcomingAppointments,pendingAppointments:l.pendingAppointments,recentPatients:l.recentPatients}):null}e.s(["default",()=>$],32312)}]);