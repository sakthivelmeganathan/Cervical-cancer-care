(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,75588,e=>{e.v({actions:"page-module__x4FzMW__actions",button:"page-module__x4FzMW__button",cancelButton:"page-module__x4FzMW__cancelButton",container:"page-module__x4FzMW__container",field:"page-module__x4FzMW__field",fields:"page-module__x4FzMW__fields",form:"page-module__x4FzMW__form",header:"page-module__x4FzMW__header",input:"page-module__x4FzMW__input",saveButton:"page-module__x4FzMW__saveButton",section:"page-module__x4FzMW__section"})},28649,e=>{"use strict";var t=e.i(43476),a=e.i(71645),l=e.i(18566),i=e.i(11795),n=e.i(22016),o=e.i(75588),s=e.i(83773);function r(){let e=(0,l.useRouter)(),r=(0,i.createClient)(),[d,c]=(0,a.useState)(!0),[u,p]=(0,a.useState)(!1),[_,m]=(0,a.useState)({full_name:"",phone:"",date_of_birth:"",blood_group:"",marital_status:"",emergency_contact_name:"",emergency_contact_phone:""}),{t:h}=(0,s.useLanguage)();(0,a.useEffect)(()=>{f()},[]);let f=async()=>{let{data:{user:t}}=await r.auth.getUser();if(!t)return void e.push("/login");let{data:a}=await r.from("users").select("full_name, phone").eq("id",t.id).single(),{data:l}=await r.from("patients").select("*").eq("user_id",t.id).single();a&&l&&m({full_name:a.full_name||"",phone:a.phone||"",date_of_birth:l.date_of_birth||"",blood_group:l.blood_group||"",marital_status:l.marital_status||"",emergency_contact_name:l.emergency_contact_name||"",emergency_contact_phone:l.emergency_contact_phone||""}),c(!1)},x=e=>{m(t=>({...t,[e.target.name]:e.target.value}))},g=async t=>{t.preventDefault(),p(!0);let{data:{user:a}}=await r.auth.getUser();if(a)try{let{error:t}=await r.from("users").update({full_name:_.full_name,phone:_.phone}).eq("id",a.id);if(t)throw t;let{error:l}=await r.from("patients").update({date_of_birth:_.date_of_birth||null,blood_group:_.blood_group,marital_status:_.marital_status,emergency_contact_name:_.emergency_contact_name,emergency_contact_phone:_.emergency_contact_phone}).eq("user_id",a.id);if(l)throw l;e.push("/patient/profile"),e.refresh()}catch(e){console.error("Error updating profile:",JSON.stringify(e,null,2),e),alert(`Failed to update profile: ${e.message||"Unknown error"}`)}finally{p(!1)}};return d?(0,t.jsx)("div",{className:o.default.container,children:h("common.loading")}):(0,t.jsxs)("div",{className:o.default.container,children:[(0,t.jsxs)("header",{className:o.default.header,children:[(0,t.jsx)("h1",{children:h("profileEdit.title")}),(0,t.jsx)("p",{children:h("profileEdit.subtitle")})]}),(0,t.jsxs)("form",{onSubmit:g,className:o.default.form,children:[(0,t.jsxs)("div",{className:o.default.section,children:[(0,t.jsx)("h2",{children:h("profileEdit.personalDetails")}),(0,t.jsxs)("div",{className:o.default.fields,children:[(0,t.jsxs)("div",{className:o.default.field,children:[(0,t.jsx)("label",{htmlFor:"full_name",children:h("patient.profile.fullName")}),(0,t.jsx)("input",{type:"text",id:"full_name",name:"full_name",value:_.full_name,onChange:x,className:o.default.input,required:!0})]}),(0,t.jsxs)("div",{className:o.default.field,children:[(0,t.jsx)("label",{htmlFor:"phone",children:h("patient.profile.phone")}),(0,t.jsx)("input",{type:"tel",id:"phone",name:"phone",value:_.phone,onChange:x,className:o.default.input})]}),(0,t.jsxs)("div",{className:o.default.field,children:[(0,t.jsx)("label",{htmlFor:"date_of_birth",children:h("patient.profile.dateOfBirth")}),(0,t.jsx)("input",{type:"date",id:"date_of_birth",name:"date_of_birth",value:_.date_of_birth,onChange:x,className:o.default.input})]}),(0,t.jsxs)("div",{className:o.default.field,children:[(0,t.jsx)("label",{htmlFor:"marital_status",children:h("patient.profile.maritalStatus")}),(0,t.jsxs)("select",{id:"marital_status",name:"marital_status",value:_.marital_status,onChange:x,className:o.default.input,children:[(0,t.jsx)("option",{value:"",children:h("profileEdit.selectStatus")}),(0,t.jsx)("option",{value:"Single",children:h("profileEdit.maritalStatusOptions.single")}),(0,t.jsx)("option",{value:"Married",children:h("profileEdit.maritalStatusOptions.married")}),(0,t.jsx)("option",{value:"Divorced",children:h("profileEdit.maritalStatusOptions.divorced")}),(0,t.jsx)("option",{value:"Widowed",children:h("profileEdit.maritalStatusOptions.widowed")})]})]})]})]}),(0,t.jsxs)("div",{className:o.default.section,children:[(0,t.jsx)("h2",{children:h("profileEdit.medicalInfo")}),(0,t.jsx)("div",{className:o.default.fields,children:(0,t.jsxs)("div",{className:o.default.field,children:[(0,t.jsx)("label",{htmlFor:"blood_group",children:h("patient.profile.bloodGroup")}),(0,t.jsxs)("select",{id:"blood_group",name:"blood_group",value:_.blood_group,onChange:x,className:o.default.input,children:[(0,t.jsx)("option",{value:"",children:h("profileEdit.selectBloodGroup")}),(0,t.jsx)("option",{value:"A+",children:"A+"}),(0,t.jsx)("option",{value:"A-",children:"A-"}),(0,t.jsx)("option",{value:"B+",children:"B+"}),(0,t.jsx)("option",{value:"B-",children:"B-"}),(0,t.jsx)("option",{value:"AB+",children:"AB+"}),(0,t.jsx)("option",{value:"AB-",children:"AB-"}),(0,t.jsx)("option",{value:"O+",children:"O+"}),(0,t.jsx)("option",{value:"O-",children:"O-"})]})]})})]}),(0,t.jsxs)("div",{className:o.default.section,children:[(0,t.jsx)("h2",{children:h("profileEdit.emergencyContact")}),(0,t.jsxs)("div",{className:o.default.fields,children:[(0,t.jsxs)("div",{className:o.default.field,children:[(0,t.jsx)("label",{htmlFor:"emergency_contact_name",children:h("patient.profile.contactName")}),(0,t.jsx)("input",{type:"text",id:"emergency_contact_name",name:"emergency_contact_name",value:_.emergency_contact_name,onChange:x,className:o.default.input})]}),(0,t.jsxs)("div",{className:o.default.field,children:[(0,t.jsx)("label",{htmlFor:"emergency_contact_phone",children:h("patient.profile.contactPhone")}),(0,t.jsx)("input",{type:"tel",id:"emergency_contact_phone",name:"emergency_contact_phone",value:_.emergency_contact_phone,onChange:x,className:o.default.input})]})]})]}),(0,t.jsxs)("div",{className:o.default.actions,children:[(0,t.jsx)(n.default,{href:"/patient/profile",className:`${o.default.button} ${o.default.cancelButton}`,children:h("profileEdit.cancel")}),(0,t.jsx)("button",{type:"submit",className:`${o.default.button} ${o.default.saveButton}`,disabled:u,children:h(u?"profileEdit.saving":"profileEdit.saveChanges")})]})]})]})}e.s(["default",()=>r])}]);