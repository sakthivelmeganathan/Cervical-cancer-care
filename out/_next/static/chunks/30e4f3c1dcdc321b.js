(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,88011,e=>{e.v({appointmentItem:"page-module__rT-CCW__appointmentItem",appointmentsList:"page-module__rT-CCW__appointmentsList",avatar:"page-module__rT-CCW__avatar",calendarCard:"page-module__rT-CCW__calendarCard",calendarTitle:"page-module__rT-CCW__calendarTitle",calendarWrapper:"page-module__rT-CCW__calendarWrapper",container:"page-module__rT-CCW__container",dateTitle:"page-module__rT-CCW__dateTitle",duration:"page-module__rT-CCW__duration",emptyState:"page-module__rT-CCW__emptyState",filterBtn:"page-module__rT-CCW__filterBtn",filterBtnActive:"page-module__rT-CCW__filterBtnActive",filters:"page-module__rT-CCW__filters",grid:"page-module__rT-CCW__grid",header:"page-module__rT-CCW__header",listCard:"page-module__rT-CCW__listCard",listHeader:"page-module__rT-CCW__listHeader",name:"page-module__rT-CCW__name",patientInfo:"page-module__rT-CCW__patientInfo",statusBadge:"page-module__rT-CCW__statusBadge",status_cancelled:"page-module__rT-CCW__status_cancelled",status_completed:"page-module__rT-CCW__status_completed",status_scheduled:"page-module__rT-CCW__status_scheduled",timeInfo:"page-module__rT-CCW__timeInfo",type:"page-module__rT-CCW__type"})},94499,e=>{"use strict";var t=e.i(43476),a=e.i(71645),n=e.i(18566),s=e.i(11795),l=e.i(37728),i=e.i(88011),d=e.i(83773);function r({initialAppointments:e}){let[n,r]=(0,a.useState)(new Date),[o,p]=(0,a.useState)("all"),[c,u]=(0,a.useState)(null),[m,_]=(0,a.useState)(""),[g,C]=(0,a.useState)(!1),f=(0,s.createClient)(),h=e.filter(e=>{let t=new Date(e.appointment_date);return t.getDate()===n.getDate()&&t.getMonth()===n.getMonth()&&t.getFullYear()===n.getFullYear()&&("all"===o||e.status===o)}),x=async e=>{if(!m)return;C(!0);let t=new Date(e.appointment_date),[a,n]=m.split(":");t.setHours(parseInt(a),parseInt(n));let{error:s}=await f.from("appointments").update({appointment_date:t.toISOString(),status:"scheduled"}).eq("id",e.id);s?alert("Failed to update time"):(u(null),window.location.reload()),C(!1)},{t:T}=(0,d.useLanguage)(),j=e=>{let t=`doctor.appointments.filter.${e}`;return T(t)===t?e.charAt(0).toUpperCase()+e.slice(1):T(t)};return(0,t.jsxs)("div",{className:i.default.container,children:[(0,t.jsxs)("header",{className:i.default.header,children:[(0,t.jsx)("h1",{children:T("doctor.appointments.title")}),(0,t.jsx)("p",{children:T("doctor.appointments.subtitle")})]}),(0,t.jsxs)("div",{className:i.default.grid,children:[(0,t.jsxs)("div",{className:i.default.calendarCard,children:[(0,t.jsx)("h2",{className:i.default.calendarTitle,children:T("doctor.appointments.calendarTitle")}),(0,t.jsx)("div",{className:i.default.calendarWrapper,children:(0,t.jsx)(l.default,{onChange:e=>{r(e)},value:n,className:"custom-calendar"})})]}),(0,t.jsxs)("div",{className:i.default.listCard,children:[(0,t.jsxs)("div",{className:i.default.listHeader,children:[(0,t.jsx)("h2",{className:i.default.dateTitle,children:n.toLocaleDateString("Dashboard"===T("common.dashboard")?"en-US":"ta-IN",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),(0,t.jsx)("div",{className:i.default.filters,children:["all","pending","scheduled","completed","cancelled"].map(e=>(0,t.jsx)("button",{className:`${i.default.filterBtn} ${o===e?i.default.filterBtnActive:""}`,onClick:()=>p(e),children:j(e)},e))})]}),(0,t.jsx)("div",{className:i.default.appointmentsList,children:h.length>0?h.map(e=>(0,t.jsxs)("div",{className:i.default.appointmentItem,children:[(0,t.jsx)("div",{className:i.default.timeInfo,children:"pending"===e.status?(0,t.jsx)("span",{className:i.default.pendingTime,children:T("doctor.appointments.timePending")}):(0,t.jsxs)(t.Fragment,{children:[new Date(e.appointment_date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),(0,t.jsx)("span",{className:i.default.duration,children:"30 min"})]})}),(0,t.jsxs)("div",{className:i.default.patientInfo,children:[(0,t.jsx)("img",{src:`https://ui-avatars.com/api/?name=${e.patient.user?.full_name||"User"}&background=random`,alt:"",className:i.default.avatar}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:i.default.name,children:e.patient.user?.full_name||T("doctor.patients.card.unknown")}),(0,t.jsx)("span",{className:i.default.type,children:e.appointment_type.replace("_"," ")})]})]}),(0,t.jsxs)("div",{className:i.default.statusSection,children:["pending"===e.status&&c!==e.id&&(0,t.jsx)("button",{className:"btn btn-sm btn-outline",onClick:()=>u(e.id),children:T("doctor.appointments.setTime")}),c===e.id?(0,t.jsxs)("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[(0,t.jsx)("input",{type:"time",className:"form-input",style:{padding:"0.25rem"},value:m,onChange:e=>_(e.target.value)}),(0,t.jsx)("button",{className:"btn btn-sm btn-primary",onClick:()=>x(e),disabled:g||!m,children:T("doctor.appointments.confirm")}),(0,t.jsx)("button",{className:"btn btn-sm btn-ghost",onClick:()=>u(null),children:"X"})]}):(0,t.jsx)("span",{className:`${i.default.statusBadge} ${i.default[`status_${e.status}`]}`,children:j(e.status)})]})]},e.id)):(0,t.jsxs)("div",{className:i.default.emptyState,children:[(0,t.jsx)("h3",{children:T("doctor.appointments.noAppointments")}),(0,t.jsx)("p",{children:T("doctor.appointments.noAppointmentsDesc")})]})})]})]})]})}function o(){let e=(0,n.useRouter)(),l=(0,s.createClient)(),[i,d]=(0,a.useState)(!0),[o,p]=(0,a.useState)([]);return((0,a.useEffect)(()=>{!async function(){let{data:{user:t}}=await l.auth.getUser();if(!t)return e.push("/login");let{data:a}=await l.from("appointments").select(`
                    id,
                    appointment_date,
                    status,
                    appointment_type,
                    patient:patients!appointments_patient_id_fkey(
                        user:users!patients_user_id_fkey(full_name, email)
                    )
                `).eq("doctor_id",t.id).order("appointment_date",{ascending:!0});p(a||[]),d(!1)}()},[e,l]),i)?(0,t.jsx)("div",{style:{padding:"2rem",textAlign:"center"},children:"Loading appointments..."}):(0,t.jsx)(r,{initialAppointments:o})}e.s(["default",()=>o],94499)}]);